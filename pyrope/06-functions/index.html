
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../05b-statements/">
      
      
        <link rel="next" href="../06b-instantiation/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Lambdas - LiveHD and Pyrope</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/table.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lambdas" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LiveHD and Pyrope" class="md-header__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../../assets/pyrope5.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiveHD and Pyrope
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lambdas
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LiveHD and Pyrope" class="md-nav__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../../assets/pyrope5.png" alt="logo">

    </a>
    LiveHD and Pyrope
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        LiveHD and Pyrope
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Livehd
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Livehd
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/00-intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/01-install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/02-usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/03-memory/" class="md-nav__link">
        Memory and concurrency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/04-api/" class="md-nav__link">
        C++ API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/05-lgraph/" class="md-nav__link">
        LGraph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/06-lnast/" class="md-nav__link">
        LNAST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/10-bazel/" class="md-nav__link">
        Bazel build
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/10b-3rdparty/" class="md-nav__link">
        3rd Party
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/11-pass/" class="md-nav__link">
        Creating a Pass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/12-github/" class="md-nav__link">
        GitHub Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/13-style/" class="md-nav__link">
        Coding Style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Pyrope
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Pyrope
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../00-hwdesign/" class="md-nav__link">
        Hardware Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01-introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02-basics/" class="md-nav__link">
        Basic syntax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03-bundle/" class="md-nav__link">
        Tuples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04-variables/" class="md-nav__link">
        Variables and types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05-assert/" class="md-nav__link">
        Verification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05b-statements/" class="md-nav__link">
        Statements
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lambdas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lambdas
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#declaration" class="md-nav__link">
    Declaration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#argument-naming" class="md-nav__link">
    Argument naming
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pass-by-reference" class="md-nav__link">
    Pass by reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-tuple" class="md-nav__link">
    Output tuple
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constraining-arguments" class="md-nav__link">
    Constraining arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06b-instantiation/" class="md-nav__link">
        Instantiation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06c-pipelining/" class="md-nav__link">
        Pipelining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07-typesystem/" class="md-nav__link">
        Type system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07b-structtype/" class="md-nav__link">
        Structural Typing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08-memories/" class="md-nav__link">
        Memories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09-stdlib/" class="md-nav__link">
        Pyrope std lib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../10-internals/" class="md-nav__link">
        Internals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../10b-vslang/" class="md-nav__link">
        vs Other Languages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../11-deprecated/" class="md-nav__link">
        Deprecated or Future
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../12-lnast/" class="md-nav__link">
        LNAST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../13-stdlib/" class="md-nav__link">
        Pyrope Standard Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#declaration" class="md-nav__link">
    Declaration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#argument-naming" class="md-nav__link">
    Argument naming
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pass-by-reference" class="md-nav__link">
    Pass by reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-tuple" class="md-nav__link">
    Output tuple
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constraining-arguments" class="md-nav__link">
    Constraining arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="lambdas">Lambdas<a class="headerlink" href="#lambdas" title="Permanent link">&para;</a></h1>
<p>A <code>lambda</code> consists of a sequence of statements that can be bound to a variable.
The variable can be copied and called as needed. Unlike most languages, Pyrope
only supports anonymous lambdas. The reason is that without it lambdas would be
assigned to a namespace. Supporting namespaces would avoid aliases across
libraries, but Pyrope allows different versions of the same library at
different parts of the project. This will effectively create a namespace alias.
The solution is to not have namespaces but relies upon variable scope to decide
which lambda to call.</p>
<div class="admonition observation">
<p class="admonition-title">Observation</p>
<p>Allowing multiple version of the same library/code is supported by Pyrope.
It looks like a strange feature from a software point of view, but it is
common in hardware to have different blocks designed/verified at different
times. The team may not want to open and modernize a block. In hardware, it
is also common to have different blocks to be compiled with different
compiler versions. These are features that Pyrope enables.</p>
</div>
<p>Pyrope divides the lambdas into two categories: <code>functions</code> and <code>procedures</code>.
Functions operate only over combinational logic. They can not have any
synthesis side-effect. This means the function outputs are only a function of
the function inputs. Any external call can only affect <code>debug</code> statements not
the synthesizable code. <code>functions</code> resemble <code>pure functions</code> in normal
programming languages. In pure functions, the function results depend only on
the input parameters. In Pyrope, they are allowed to have side effects on debug
code (non-synthesizable).</p>
<p>Non-function lambdas are called <code>procedures</code> or <code>methods</code>. The only difference
between <code>procedures</code> and <code>methods</code> is that a <code>method</code> has <code>self</code> as the first
argument in the output which allows to mutable the called tuple.</p>
<p>Lambdas also can be divided into <code>modules</code> and non-<code>modules</code>. A <code>module</code> is a
lambda visible at synthesis call hierarchy. A <code>non-module</code> is an inlined or
flattened <code>lambda</code>.</p>
<p><code>functions</code> are combinational logic, but <code>procedures</code> can have inputs and/or
outputs registerd or just be a generic pure combinational function.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Combinational (fun)</label><label for="__tabbed_1_2">Combinational (proc)</label><label for="__tabbed_1_3">Inputs Registerd (proc)</label><label for="__tabbed_1_4">Outputs Registerd (proc)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>let add=fun(a,b)-&gt;(res) {
  res = a+b
}

fun add(a,b)-&gt;(res) {  // Same as let add=fun(a,b)-&gt;(res)
  res = a+b
}
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>let add=proc(a,b)-&gt;(res) {  // nicer to use fun, but proc works
  res = a+b
}

proc add(a,b)-&gt;(res) {  // same
  res = a+b
}
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>let add=proc(reg a, reg b)-&gt;(res) {
  res = a+b
}

proc add(reg a, reg b)-&gt;(res) { // same
  res = a+b
}
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>let add=proc(a, b)-&gt;(reg res) {
  res = a+b
}

proc add(a, b)-&gt;(reg res) { // same
  res = a+b
}
</code></pre></div>
</div>
</div>
</div>
<h2 id="declaration">Declaration<a class="headerlink" href="#declaration" title="Permanent link">&para;</a></h2>
<p>Only anonymous lambdas are supported, this means that there is no global scope
for functions, procedures, or modules. The only way for a file to access a
lambda is to have access to a local variable with a definition or to "import" a
variable from another file. The more familiar <code>fun name</code> or <code>proc name</code>
declaration is also valid, but it is syntax sugar and equivalent to <code>let name =
fun</code>.</p>
<div class="highlight"><pre><span></span><code>let a_3   = {   3 }      // just scope, not a lambda. Scope is evaluate now
let a_fun = fun() { 4 }  // when a_fun is called 4 is returned

let fun3 = fun(){ 5 }    // public lambda that can be imported by other files

let x = a_3()            // compile error, explicit call not posible in scope
let x = a_fun()          // OK, explicit call needed when no arguments

assert a_3() equals 3
assert a_fun equals _:fun()
assert a_fun() equals 4
assert a_fun() == 4      // calls to eval the function
</code></pre></div>
<p>The lambda definition has the following fields:</p>
<div class="highlight"><pre><span></span><code>[GENERIC] [CAPTURE] [INPUT] [-&gt; OUTPUT] [where COND] |
</code></pre></div>
<ul>
<li>
<p><code>GENERIC</code> is an optional comma separated list of names between <code>&lt;</code> and <code>&gt;</code> to
  use as generic types in the lambda.</p>
</li>
<li>
<p><code>CAPTURE</code> has the list of capture variables for the lambda. If no capture is
  provided, no local variable can be captured by value which is equivalent to
  an empty list (<code>[]</code>), The captures are by value only, no capture by reference
  is allowed. Unlike most languages, capture must be comptime. Section
  <a href="../10-internals/#Closures">Closures</a> has more details.</p>
</li>
<li>
<p><code>INPUT</code> has a list of inputs allowed with optional types. <code>()</code> indicates no
  inputs. <code>(...args)</code> allow to accept a variable number of arguments.</p>
</li>
<li>
<p><code>OUTPUT</code> has a list of outputs allowed with optional types. <code>()</code> indicates no
  outputs.</p>
</li>
<li>
<p><code>COND</code> is the condition under which this statement is valid. The <code>COND</code> can
  use the inputs, outputs, and <code>self</code> to evaluate. If the outputs are used in
  the <code>COND</code>, the lambda must be immutable (<code>fun</code>). This means that the method
  is called when the condition could evaluate true depending on its execution,
  but being immutable there are no side effects. Section
  <a href="../07b-structtype/#lambda_overloading">overload</a> has more details.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>var add:fun(...x) = _
add = fun (...x) { x.0+x.1+x.2 }      // no IO specified
add = fun (a,b,c){ a+b+c }            // constrain inputs to a,b,c
add = fun (a,b,c){ a+b+c }            // same
add = fun (a:u32,b:s3,c){ a+b+c }     // constrain some input types
add = fun (a,b,c) -&gt; (x:u32){ a+b+c } // constrain result to u32
add = fun (a,b,c) -&gt; (res){ a+b+c }   // constrain result to be named res
add = fun (a,b:a,c:a){ a+b+c }        // constrain inputs to have same type
add = fun &lt;T&gt;(a:T,b:T,c:T){ a+b+c }   // same

x = 2
var add2:fun2(a) = _
add2 = fun       (a){   x + a }    // compile error, undefined &#39;x&#39;
add2 = fun[     ](a){   x + a }    // compile error, undefined &#39;x&#39;
add2 = fun[x    ](a){   x + a }    // explicit capture x
add2 = fun[foo=x](a){ foo + a }    // capture x but rename to something else

var y = (
  ,val:u32 = 1
  ,inc1 = fun (ref self) { self.val = u32(self.val + 1) }
)

let my_log::[debug] = fun (...inp) {
  print &quot;loging:&quot;
  for i in inp {
    print &quot; {}&quot;, i
  }
  puts
}

let f = fun&lt;X&gt;(a:X,b:X){ a+b }   // enforces a and b with same type
assert f(33:u22,100:u22)

my_log a, false, x+1
</code></pre></div>
<h2 id="argument-naming">Argument naming<a class="headerlink" href="#argument-naming" title="Permanent link">&para;</a></h2>
<p>Input arguments must be named. E.g: <code>fcall(a=2,b=3)</code> There are the following
exceptions that avoid naming arguments:</p>
<ul>
<li>
<p>If the type system can distinguish between unnamed arguments (no ambiguity)</p>
</li>
<li>
<p>If there is an argument/call match. The calling variable name has the same as an argument</p>
</li>
<li>
<p>If the argument is a single letter, and there is no name match, only position is used</p>
</li>
<li>
<p><code>self</code> does not need to be named (first argument position)</p>
</li>
</ul>
<p>There are several rules on how to handle arguments.</p>
<ul>
<li>
<p>Calls use the Uniform Function Call Syntax (UFCS) but only when <code>self</code> is defined as
  first argument. <code>(a,b).f(x,y) == f((a,b),x,y)</code></p>
</li>
<li>
<p>Pipe <code>|&gt;</code> concatenated inputs: <code>(a,b) |&gt; f(x,y) == f(x,y,a,b)</code></p>
</li>
<li>
<p>Function calls with arguments do not need parenthesis after newline or a
  variable assignment: <code>a = f(x,y)</code> is the same as <code>a = f x,y</code></p>
</li>
<li>
<p>Functions explicitly declared without arguments, do not need parenthesis in
  function call.</p>
</li>
</ul>
<p>Pyrope uses a Uniform Function Call Syntax (UFCS) when the first argument is
<code>self</code>. It resembles Nim or D UFCS but it can be different from the order in
other languages. Notice the different order in UFCS vs pipe, and also that in
the pipe the argument tuple is concatenated.</p>
<div class="highlight"><pre><span></span><code>let div  = fun (self,b) { self / b }  // named input tuple
let div2 = fun (...x){ x.0 / x.1 }    // unnamed input tuple

let noarg = fun () { 33 }         // explicit no args

assert 33 == noarg()

assert noarg == 33 // compile error, `noarg()` needed for calls without arguments

a=div(3  , 4  , 3)       // compile error, div has 2 inputs
b=div(self=8, b=4)       // OK, 2
c=div self=8, b=4        // compile error, parenthesis needed for complex call
d=(self=8).div(b=2)      // OK, 4
d=(8).div(b=2)           // OK, 4 . self does not need to be named
d=8.div(2)               // OK, single character inputs no need to be named
e=(self=8).div b=2       // compile error, parenthesis needed for complex call

h=div2(8, 4, 3)          // OK, 2 (3rd arg is not used)
i=8.div2(4,3)            // compile error, no self in div2

j=(8,4)  |&gt; div2         // OK, 2, same as div2(8,4)
j=(8,4)  |&gt; div2()       // OK, 2, same as div2(8,4)
k=(4)    |&gt; div2(8)      // OK, 2, same as div2(8,4)
l=(4,33) |&gt; div2(8)      // OK, 2, same as div2(8,4,33)
m=4      |&gt; div2 8       // compile error, parenthesis needed for complex call

n=div((8,4), 3)          // compile error: (8,4)/3 is undefined
o=(8,4).div2(1)          // compile error: (8,4)/1 is undefined
</code></pre></div>
<p>The UFCS allows to have <code>lambdas</code> to call any tuple, but if the called tuple
has a lambda defined with the same name a compile error is generated. Like with
variables, Pyrope does not allow <code>lambda</code> call shadowing. Polymorphism is allowed
but only explicit one as explained later.</p>
<div class="highlight"><pre><span></span><code>var tup = (
  ,let f1 = fun(self) { 1 }
)

let f1 = fun (self){ 2 }   // compile error, f1 shadows tup.f1
let f2 = fun (self){ 3 }

assert f1()         != 0  // compile error, missing argument
assert f1(tup)      != 0  // compile error, f1 shadowing (tup.f1 and f1)
assert 4.f1()       != 0  // compile error, f1 can be called for tup, so shadow
assert tup.f1()     != 0  // compile error, f1 is shadowing

let xx = fun[tup] { tup.f1() } // OK, function restricted scope for f1
assert xx()

assert (4:tup).f1() == 1
assert 4.f2()       == 3  // UFCS call
assert tup.f1()     == 1
</code></pre></div>
<p>The keyword <code>self</code> is used to indicate that the function is accessing a tuple.
<code>self</code> is required to be the first argument. If the procedure modifies the tuple
contents, a <code>ref self</code> must be passed as input.</p>
<div class="highlight"><pre><span></span><code>var tup2 = (
  ,val:u8 = _
  ,upd = proc(ref self) { self.val::[saturate] += 1 }
  ,calc = fun(self) { self.val}
)
</code></pre></div>
<p>A lambda call uses parenthesis (<code>foo() or foo(1,2)</code>). The parenthesis can be
avoid in tree conditions: (1) arguments are passed in a simple function call
statement; (2) after a pipeline directive; (3) the variable has a getter method
(<code>get</code>).</p>
<div class="highlight"><pre><span></span><code>no_arg_fun()     // must use explicit parenthesis/called
arg_fun 1,2      // parenthesis are optional
arg_fun(1,2)     // OK too
(1,2) |&gt; arg_fun // OK too, it is after |&gt;

var intercepted:(
 ,field:u32
 ,getter=fun(self) { self.field + 1 }
 ,setter=fun(ref self,v ) { self.field = v }
) = 0

cassert intercepted == 1  // will call get method without explicit call
cassert intercepted.field == 0
</code></pre></div>
<h2 id="pass-by-reference">Pass by reference<a class="headerlink" href="#pass-by-reference" title="Permanent link">&para;</a></h2>
<p>Pyrope is an HDL, and as such, there are not memory allocation issues. This
means that all the arguments are pass by value and the language has value
semantics. In other words, there is not need to worry about ownership or
move/forward semantics like in C++/Rust. All the arguments are always by value.
Nevertheless, sometimes is useful to pass a reference to an array/register so
that it can be updated/accessed on different lambdas.</p>
<p>Pyrope arguments are by value, unless the <code>ref</code> keyword is used. Pass by
reference is needed to avoid the copy by value of the function call. Unlike
non-hardware languages, there is no performance overhead in passing by value.
The reason for passing as reference is to allow the lambda to operate over the
passed argument. If modified, it behaves like if it were an implicit output.
This is quite useful for large objects like memories to avoid the copy.</p>
<p>The pass by reference behaves like if the calling lambda were inlined in the
caller lambda while still respecting the lambda scope. The <code>ref</code> keyword must
be explicit in the lambda input definition but also in the lambda call. The
lambda outputs can not have a <code>ref</code> modifier.</p>
<p>No logical or arithmetic operation can be done with a <code>ref</code>. As a result, it is
only useful for lambda input arguments.</p>
<div class="highlight"><pre><span></span><code>let inc1 = fun(ref a) { a += 1 }

let x = 3
inc1(ref x)       // compile error, `x` is immutable but modified inside inc1

var y = 3
inc1(ref y)
assert y == 4

let banner = fun() { puts &quot;hello&quot;  }
let execute_method = fun(fn) {
  fn() // prints hello when banner passed as argument
}

execute_method(banner)     // OK
</code></pre></div>
<h2 id="output-tuple">Output tuple<a class="headerlink" href="#output-tuple" title="Permanent link">&para;</a></h2>
<p>Pyrope everything is a tuple, even the output or return from a lambda. When a
single element is returned, it can be an unnamed tuple by omiting parenthesis.</p>
<div class="highlight"><pre><span></span><code>let ret1 = fun()-&gt;(a:int) { // named
  a = 1
}

let ret2 = fun()-&gt;a:int {   // unnamed
  a = 2
}

let ret3 = fun()-&gt;(a,b) {   // named
  a = 3
  b = 4
}

let a1 = ret1()
assert a1.a == 1 // NOT a1 == 1

let a2 = ret2()
assert a2 == 1   // NOT a2.a == 1

let a3 = ret3()
assert a3.a == 3 and a2.b == 4

let (x1,x2) = ret3()
assert x1   == 3 and x2   == 4
</code></pre></div>
<h2 id="attributes">Attributes<a class="headerlink" href="#attributes" title="Permanent link">&para;</a></h2>
<p>Variables can have attributes, but <code>procedures</code> can also have them. Procedure
attributes have only one direction from inside the method to outside/caller.
They can be used to signal out of band information about the procedude. Attributes
can only be <code>integer</code>, <code>bool</code>, or <code>string</code>. Depending on the type, they are
initialized to <code>0</code>, <code>false</code>, or <code>""</code>.</p>
<p>The procedure attribute is stored in the variable that keeps the lambda. This
means that it can be checked before or after the lambda call, and that
different variables can point to the same procedure but keep different
attributes.</p>
<div class="highlight"><pre><span></span><code>let p1 = proc(a)-&gt;(res) {
  self.[my_zero_found] or= (a == 0)

  res = a + 1
}

let p2 = p1      // copy
let p3 = ref p1  // reference

test &quot;testing p1&quot; {
  assert p1.[my_zero_found] == false
  assert p2.[my_zero_found] == false

  cassert p1(3) == 4
  assert p1.[my_zero_found] == false

  cassert p1(0) == 1
  assert p1.my_zero_found == true

  cassert p1(50) == 51
  assert p1.[my_zero_found] == true
  assert p2.[my_zero_found] == false
  assert p3.[my_zero_found] == true
}
</code></pre></div>
<h2 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">&para;</a></h2>
<p>Pyrope arguments are by value, unless the <code>ref</code> keyword is used. <code>ref</code> is
needed when a method intends to update the tuple contents. In this case, <code>ref
self</code> argument behaves like a pass by reference in non-hardware languages. This
means that the tuple fields are updated as the method executes, it does not
wait until the method finishes execution. A method without the <code>ref</code> keyword is
a pass by value call. Since all the inputs are immutable by default (<code>let</code>),
any <code>self</code> updates should generate a compile error.</p>
<div class="highlight"><pre><span></span><code>let Nested_call = (
  ,var x = 1
  ,let outter= proc(ref self) {  self.x = 100 ; self.inner(); self.x = 5 }
  ,let inner = fun(self) { assert self.x == 100 }
  ,let faulty = proc(self) { self.x = 55 } // compile error, immutable self
  ,proc okcall(ref self) { self.x = 55 }   // equivalent to let okcall=proc
)
</code></pre></div>
<p><code>self</code> can also be returned but this behaves like a normal copy by value
variable return.</p>
<div class="highlight"><pre><span></span><code>var a_1 = (
  ,x:u10
  ,let f1 = fun(ref self,x)-&gt;(self) { // BOTH ref self and return self is OK
    self.x = x
    self
  }
)

a_1.f1(3)
var a_2 = a_1.f1(4)  // a_2 is updated, not a_1
assert a_1.x == 3 and a_2.x == 4

// Same behavior as in a function with UFCS
fun2 = fun (ref self, x) { self.x = x }

a_1.fun2(10)
var a_3 = a_1.fun2(20)
assert a_1 == 10 and a_3 == 20
</code></pre></div>
<p>Since UFCS does not allow shadowing, a wrapper must be built or a compile error is generated.</p>
<div class="highlight"><pre><span></span><code>var counter = (
  ,var val:i32 = 0
  ,let inc = fun (ref self, v){ self.var += v }
)

assert counter.val == 0
counter.inc(3)
assert counter.val == 3

let inc = fun (ref self, v) { self.var *= v } // NOT INC but multiply
counter.inc(2)             // compile error, multiple inc options
assert 44.inc(2) == 8

counter.val = 5
let mul = inc
counter.mul(2)             // call the new mul method with UFCS
assert counter.val == 10

mul(counter, 2)            // also legal
assert counter.val == 20
</code></pre></div>
<p>It is possible to add new methods after the type declaration. In some
languages, this is called extension functions.</p>
<div class="highlight"><pre><span></span><code>let t1 = (a:u32)

var x:t1 = (a=3)

t1.double = proc(ref self) { self.a *= 2 }  // extension function
// previous is exactly the same as:
// t1 = t1 ++ (double = proc(ref self) { self.a *= 2 })

var y:t1 = (a=3)
x.double             // compile error, double method does not exit
y.double             // OK
assert y.a == 6
</code></pre></div>
<h3 id="constraining-arguments">Constraining arguments<a class="headerlink" href="#constraining-arguments" title="Permanent link">&para;</a></h3>
<p>Arguments can constrain the inputs and input types. Unconstrained input types
allow for more freedom and a potentially variable number of arguments generics, but
it can be error-prone.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">unconstrained declaration</label><label for="__tabbed_2_2">constrained declaration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>foo = fun (self) { puts &quot;fun.foo&quot; }
a = (
  ,foo = fun () {
     bar = fun() { puts &quot;bar&quot; }
     puts &quot;mem.foo&quot;
     return (bar=bar)
  }
)
b = 3
c = &quot;string&quot;

b.foo         // prints &quot;fun.foo&quot;
b.foo()       // prints &quot;fun.foo&quot;
x = a.foo     // prints &quot;mem.foo&quot;
y = a.foo()   // prints &quot;mem.foo&quot;
x()           // prints &quot;bar&quot;

a.foo.bar()   // prints &quot;mem.foo&quot; and then &quot;bar&quot;
a.foo().bar() // prints &quot;mem.foo&quot; and then &quot;bar&quot;
a.foo().bar   // prints &quot;mem.foo&quot; and then &quot;bar&quot;

c.foo         // prints &quot;fun.foo&quot;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>foo = fun (self:int) { puts &quot;fun.foo&quot; }
a = (
  ,foo = fun () {
     bar = fun() { puts &quot;bar&quot; }
     puts &quot;mem.foo&quot;
     return (bar=bar)
  }
)
b = 3
c = &quot;string&quot;

b.foo         // prints &quot;fun.foo&quot;
b.foo()       // prints &quot;fun.foo&quot;
x = a.foo     // prints &quot;mem.foo&quot;
y = a.foo()   // prints &quot;mem.foo&quot;
x()           // prints &quot;bar&quot;

a.foo.bar()   // prints &quot;mem.foo&quot; and then &quot;bar&quot;
a.foo().bar() // prints &quot;mem.foo&quot; and then &quot;bar&quot;
a.foo().bar   // prints &quot;mem.foo&quot; and then &quot;bar&quot;

c.foo         // compile error, undefined &#39;foo&#39; field/call
</code></pre></div>
</div>
</div>
</div>
<p>The <code>where</code> statement also allows to constrain arguments. This is a sample of
fibonnaci implementation with and without <code>where</code> clauses. Section
<a href="../07b-structtype/#lambda_overloading">overload</a> has more details on the method
overloading.</p>
<div class="highlight"><pre><span></span><code>let fib1 = fun(n) where n==0 {0}
        ++ fun(n) where n==1 {1}
        ++ fun(n)            { fib1(n-1) + fib1(n-2) }

assert fib1(10) == 55

let fib2 = fun(n) {
  return match n {
    == 0 {0}
    == 1 {1}
    else {fib2(n-1) + fib2(n-2)}
  }
}

assert fib2(10) == 55
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "navigation.sections", "navigation.instant", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>