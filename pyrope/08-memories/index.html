
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../07b-structtype/">
      
      
        <link rel="next" href="../09-stdlib/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.8">
    
    
      
        <title>Memories - LiveHD and Pyrope</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/table.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#memories" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LiveHD and Pyrope" class="md-header__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../../assets/pyrope5.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LiveHD and Pyrope
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Memories
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LiveHD and Pyrope" class="md-nav__button md-logo" aria-label="LiveHD and Pyrope" data-md-component="logo">
      
  <img src="../../assets/pyrope5.png" alt="logo">

    </a>
    LiveHD and Pyrope
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/masc-ucsc/livehd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LiveHD and Pyrope
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Livehd
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Livehd
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/00-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/01-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/02-usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/03-memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory and concurrency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/04-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/05-lgraph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LGraph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/06-lnast/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LNAST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/10-bazel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bazel build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/10b-3rdparty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3rd Party
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/11-pass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a Pass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/12-github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livehd/13-style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding Style
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Pyrope
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Pyrope
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-hwdesign/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hardware Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic syntax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-bundle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variables and types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-assert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05b-statements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lambdas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06b-instantiation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Instantiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06c-pipelining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipelining
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-typesystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07b-structtype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structural Typing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Memories
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Memories
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#async-memories-or-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Async memories or arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sync-memories" class="md-nav__link">
    <span class="md-ellipsis">
      Sync memories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sync memories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flop-the-inputs-or-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Flop the inputs or outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtl-instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      RTL instantiation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multidimensional-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Multidimensional arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#array-index" class="md-nav__link">
    <span class="md-ellipsis">
      Array index
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Array index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reset-and-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Reset and initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-stdlib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pyrope std lib
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-internals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10b-vslang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vs Other Languages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-deprecated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deprecated or Future
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-lnast/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LNAST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-stdlib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pyrope Standard Library
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#async-memories-or-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Async memories or arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sync-memories" class="md-nav__link">
    <span class="md-ellipsis">
      Sync memories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sync memories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flop-the-inputs-or-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Flop the inputs or outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtl-instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      RTL instantiation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multidimensional-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Multidimensional arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#array-index" class="md-nav__link">
    <span class="md-ellipsis">
      Array index
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Array index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reset-and-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Reset and initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="memories">Memories<a class="headerlink" href="#memories" title="Permanent link">&para;</a></h1>
<p>A significant effort of hardware design revolves around memories. Unlike Von
Neumann models, memories must be explicitly managed. Some list of concerns
when designing memories in ASIC/FPGAs:</p>
<ul>
<li>Reads and Writes may have different number of cycles to take effect</li>
<li>Reset does not initialize memory contents</li>
<li>There may not be data forwarding if a read and a write happen in the same cycle</li>
<li>ASIC memories come from memory compilers that require custom setup pins and connections</li>
<li>FPGA memories tend to have their own set of constraints too</li>
<li>Logic around memories like BIST has to be added before fabrication</li>
</ul>
<p>This constrains the language, it is difficult to have a typical vector/memory
provided by the language that handles all these cases. Instead, the complex
memories are managed by the Pyrope standard library.</p>
<p>The flow directly supports arrays/memories in two ways:</p>
<ul>
<li>Async memories or arrays</li>
<li>RTL instantiation</li>
</ul>
<h2 id="async-memories-or-arrays">Async memories or arrays<a class="headerlink" href="#async-memories-or-arrays" title="Permanent link">&para;</a></h2>
<p>Asynchronous memories, async memories for short, have the same Pyrope tuple
interface. The difference between tuples/arrays and async memories is that the
async memories preserve the array contents across cycles. In contrast, the array
contents are cleared at the end of each cycle.</p>
<p>In Pyrope, an async memory has one cycle to write a value and 0 cycles to read.
The memory has forwarding by default, which behaves like a 0 cycle
read/write. From a non-hardware programmer, the default memory looks like an array with
persistence across cycles.</p>
<p>Pyrope async memories behave like what a "traditional software programmer" will
expect in an array. This means that values are initialized and there is
forwarding enabled. This is not what a "traditional hardware programmer" will expect.
In languages like CHISEL there is no forwarding or initialization. In Pyrope is
possible to have different options of async memories, but those should use the
RTL interface.</p>
<p>The async memories behave like tuples/arrays but there is a small difference,
the persistence of state between clock cycles. To be persistent across clock
cycles, this is achieved with a <code>reg</code> declaration. When a variable is declared
with <code>var</code> the contents are lost at the end of the cycle, when declared with
<code>reg</code> the contents are preserved across cycles.</p>
<p>In most cases, the arrays and async memories can be inferred automatically. The
maximum/minimum value on the index effectively sets the size and the default
initialization is zero.</p>
<div class="highlight"><pre><span></span><code>reg mem:[] = 0
mem[3]   = something // async memory
var array:[] = _
array[3] = something // array no cross cycles persistence
</code></pre></div>
<div class="highlight"><pre><span></span><code>var index:u7 = _
var index2:u6 = _

array[index] = something
some_result  = array[index2+3]
</code></pre></div>
<p>In the previous example, the compiler infers that the bundle at most has 127 entries.</p>
<p>There are several constructs to declare arrays or async memories:</p>
<div class="highlight"><pre><span></span><code>reg mem1:[16]i8 = 3   // mem 16bit memory initialized to 3 with type i8
reg mem2:[16]i8 = _   // mem 16bit memory initialized to 0 with type i8
var mem3:[] = 0sb?        // array infer size and type, 0sb? initialized
var mem4:[13] = 0         // array 13 entries size, initialized to zero
</code></pre></div>
<p>Pyrope allows slicing of bundles and hence arrays.</p>
<div class="highlight"><pre><span></span><code>x1 = array[first..&lt;last]  // from first to last, last not included
x2 = array[first..=last]  // from first to last, last included
x3 = array[first..+size]  // from first to first+size, first+size. not included
</code></pre></div>
<p>Since bundles are multi-dimensional, arrays or async memories are multi-dimensional too.</p>
<div class="highlight"><pre><span></span><code>a[3][4] = 1

var b:[4][8]u8 = 13

assert b[2][7] == 13
assert b[2][10]      // compile error, &#39;10&#39; is out of bound access for &#39;b[2]&#39;
</code></pre></div>
<p>It is possible to initialize the async memory with an array. The initialization
of async memories happens whenever <code>reset</code> is set on the system. A key difference
between arrays (no clock) and memories is that arrays initialization value must
be <code>comptime</code> while <code>memories</code> and <code>reg</code> can have a sequence of statements to
generate a reset value. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Pyrope array syntax</label><label for="__tabbed_1_2">Explicit initialization</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>var mem1:[4][8]u5 = 0
var reset_value:[3][8]u5:[comptime] = _ // only used during reset
for i in 0..&lt;3 {
  for j in 0..&lt;8 {
    reset_value[i][j] = j
  }
}
reg mem2 = reset_value   // infer async mem u5[3][8]
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>var mem = ( 
  ,(u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0))
  ,(u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0))
  ,(u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0))
  ,(u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0), u5(0))
)
reg mem2 = ( 
  ,(u5(0), u5(1), u5(2), u5(3), u5(4), u5(5), u5(6), u5(7))
  ,(u5(0), u5(1), u5(2), u5(3), u5(4), u5(5), u5(6), u5(7))
  ,(u5(0), u5(1), u5(2), u5(3), u5(4), u5(5), u5(6), u5(7))
)
</code></pre></div>
</div>
</div>
</div>
<h2 id="sync-memories">Sync memories<a class="headerlink" href="#sync-memories" title="Permanent link">&para;</a></h2>
<p>Pyrope asynchronous memories provide the result of the read address and update
their contents on the same cycle. This means that traditional SRAM arrays can
not be directly used. Most SRAM arrays either flop the inputs or flop the
outputs (sense amplifiers). This document calls synchronous memories the
memories that either has a flop input or an output.</p>
<p>There are two ways in Pyrope to instantiate more traditional synchronous
memories. Either use async memories with flopped inputs/outputs or do a
direct RTL instantiation.</p>
<h3 id="flop-the-inputs-or-outputs">Flop the inputs or outputs<a class="headerlink" href="#flop-the-inputs-or-outputs" title="Permanent link">&para;</a></h3>
<p>When either the inputs or the output of the asynchronous memory access is
directly connected to a flop, the flow can recognize the memory as asynchronous memory. A further constrain is that only single dimension memories.
Multi-dimensional memories or memories with partial updates need to use the
RTL instantiation.</p>
<p>To illustrate the point of simple single dimensional synchronous memories, this
is a typical decode stage from an in-order CPU:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Flop the inputs</label><label for="__tabbed_2_2">Flop the outputs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>reg rf:[32]i64 = 0sb?   // random initialized

reg a:(addr1:u5, addr2:u5) = (0,0)

data_rs1 = rf[a.addr1]
data_rs2 = rf[a.addr2]

a = (insn[8..=11], insn[0..=4])
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>var rf:[32]i64 = 0sb?

reg a:(data1:i64, data2:i64) = _

data_rs1 = a.data1
data_rs2 = a.data2

a = (rf[insn[8..=11]], rf[insn[0..=4]])
</code></pre></div>
</div>
</div>
</div>
<h3 id="rtl-instantiation">RTL instantiation<a class="headerlink" href="#rtl-instantiation" title="Permanent link">&para;</a></h3>
<p>There are several constraints and additional options to synchronous memories
that the async memory interface can not provide: multi-dimension, partial updates,
negative edge clock...</p>
<p>Pyrope allows for a direct call to LiveHD cells with the RTL instantiation, as
such that memories can be created directly.</p>
<div class="highlight"><pre><span></span><code>// A 2rd+1wr memory (RF type)

mem.addr    = (raddr0, raddr1, wraddr)
mem.bits    = 4
mem.size    = 16
mem.clock   = my_clock
mem.din     = (0, 0, din0)
mem.enable  = (1, 1, we0)

mem.fwd     = false
mem.latency = (1, 1, 1)
mem.wensize = 1 // we bit (no write mask)
mem.rdport  = (-1,1,0) // 0 WR, !=0 -&gt; RD

res =#[..] __memory(mem)

q0 = res.0
q1 = res.1
</code></pre></div>
<p>The previous code directly instantiates a memory and passes the configuration. </p>
<p>Multi cycle memories are pipelined elements, and using them requires the <code>=#[..]</code> assignment
and the same rules as pipeline flops apply (See <a href="06b-pipelining.md">pipelining</a>).</p>
<h2 id="multidimensional-arrays">Multidimensional arrays<a class="headerlink" href="#multidimensional-arrays" title="Permanent link">&para;</a></h2>
<p>Pyrope supports multi-dimensional arrays, it is possible to slice the array by
dimension. The entries are in a row-major order.</p>
<div class="highlight"><pre><span></span><code>var d2:[2][2] = ((1,2),(3,4))
assert d2[0][0] == 1 and d2[0][1] == 2 and d2[1][0] == 3 and d2[1][1] == 4

assert d2[0] == (1,2) and d2[1] == (2,3)
</code></pre></div>
<p>The <code>for</code> iterator goes over each entry of the bundle/array. If a matrix, it
does in row-major order. This allows building a simple function to flatten
multi-dimensional arrays.</p>
<div class="highlight"><pre><span></span><code>let flatten = fun(...arr) {
  var res = 0
  for i in arr {
    res ++= i
  }
  return res
}

assert flatten(d2) == (1,2,3,4)
assert flatten((((1),2),3),4) == (1,2,3,4)
</code></pre></div>
<h2 id="array-index">Array index<a class="headerlink" href="#array-index" title="Permanent link">&para;</a></h2>
<p>Array index by default are unsigned integers, but the index can be constrained
with tuples or by requiring an enumerate.</p>
<div class="highlight"><pre><span></span><code>var x1:[2]u3 = (0,1)
assert x1[0] == 0 and x1[1] == 1

var X=enum(
  ,t1 = 0 // sequential enum, not one hot enum (explicit assign)
  ,t2
  ,t3
)

var x2:[X]u3 = _
x2[X.t1] = 0
x2[X.t2] = 1
x2[0]              // compile error, only enum index

var x3:[-8..&lt;7]u3 = _  // accept signed values

var x4:[100..&lt;132]u3 = _

assert x4[100] == 0
assert x4[3]       // compile error, out of bounds index
</code></pre></div>
<h3 id="reset-and-initialization">Reset and initialization<a class="headerlink" href="#reset-and-initialization" title="Permanent link">&para;</a></h3>
<p>Like the <code>let</code> and <code>var</code> statements, <code>reg</code> statements require an initialization
value. While <code>let/var</code> initialize every cycle, the <code>reg</code> initialization is the
value to set during reset.</p>
<p>Like in <code>let/var</code> cases, the reset/initialization value can use the traditional
Verilog uninitialized (<code>0sb?</code>) contents. The Pyrope semantics for any bit with
<code>?</code> value is to respect arithmetic Verilog semantics at compile time, but to
randomly generate a zero/ones for each simulation. As a result assertions can
fail with unknowns.</p>
<div class="highlight"><pre><span></span><code>reg r_ver = 0sb?

reg r = _
var v = _

assert v == 0 and r == 0

assert !(r_ver != 0)    // it will randomly fail
assert !(r_ver == 0)    // it will randomly fail
assert !(r_ver != 0sb?) // it will randomly fail
assert !(r_ver == 0sb?) // it will randomly fail
</code></pre></div>
<p>The reset for arrays may take several cycles to take effect, this can lead to
unexpected results during the reset period. Memories and registers are randomly
initialized before reset during simulation. There is no guarantee of zero
initialization before reset.</p>
<div class="highlight"><pre><span></span><code>var arr:[] = (0,1,2,3,4,5,6,7)

always assert arr[0] == 0 and arr[7] == 7  // may FAIL during reset

reg mem:[] = (0,1,2,3,4,5,6,7)

always assert mem[7] == 7                  // may FAIL during reset
always assert mem[7] == 7 unless mem.reset // OK
assert mem[7] == 7                         // OK, not checked during reset
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "navigation.sections", "navigation.instant", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>